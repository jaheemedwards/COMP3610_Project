🚀 Starting training pipeline...
📂 Loading data files...
Loaded 45043 news records 📈 and 1836992 price records 💵.
📊 Calculating next day's closing price...
🔗 Merging news with next close prices...
Merged data has 43643 records 🔥 (dropped 1400 rows without NextClose).
📝 Creating binary labels (1 = price up/stay, 0 = price down)...
Class distribution:
{1: 23273, 0: 20370}
🔠 Vectorizing news titles using TF-IDF and encoding Ticker...
🚀 Starting training pipeline...
📂 Loading data files...
Loaded 45043 news records 📈 and 1836992 price records 💵.
📊 Calculating next day's closing price...
🔗 Merging news with next close prices...
Merged data has 43643 records 🔥 (dropped 1400 rows without NextClose).
📝 Creating binary labels (1 = price up/stay, 0 = price down)...
Class distribution:
{1: 23273, 0: 20370}
🔠 Vectorizing news titles using TF-IDF and encoding Ticker...
Data shape: (43643, 2), Labels shape: (43643,)
📚 Splitting into train and test sets...
Train size: 34914, Test size: 8729
🤖 Training XGBoost classifier...
✅ Model training complete.
📈 Evaluating model...
📊 Classification Report:
              precision    recall  f1-score   support

           0       0.58      0.30      0.39      4074
           1       0.57      0.81      0.67      4655

    accuracy                           0.57      8729
   macro avg       0.58      0.56      0.53      8729
weighted avg       0.58      0.57      0.54      8729

🔴 Confusion Matrix:
[[1207 2867]
 [ 865 3790]]
📉 Saving confusion matrix chart...
📸 Confusion matrix saved as confusion_matrix_updown.png
💾 Saving model and vectorizer to disk...
💾 Saved models\xgb_updown_model.joblib and models\tfidf_vectorizer_updown.joblib.
⏱️ Model training completed in 5.04 seconds.
🎉 Training pipeline complete.

